"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.validate = exports.getValidator = exports.validateState = exports.countNumbers = exports.countUpperCase = exports.count = exports.ValidationType = void 0;

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _validationFunc;

/* Predefined validation options. However, a custom rule, which takes a function, can be created
   and thus any validation rule that is desired, can be created. */
var ValidationType;
/* Function that is tied to a custom rule. Must return a boolean and will always receive two arguments: 
   value: current value of the input field where this custom rule is tied 
   state: the most updated state of the entire form. */

exports.ValidationType = ValidationType;

(function (ValidationType) {
  ValidationType["Require"] = "isRequired";
  ValidationType["MinLength"] = "minLength";
  ValidationType["MaxLength"] = "maxLength";
  ValidationType["MinValue"] = "minValue";
  ValidationType["MaxValue"] = "maxValue";
  ValidationType["MinUppercaseCharacters"] = "minUppercaseCharacters";
  ValidationType["MaxUppercaseCharacters"] = "maxUppercaseCharacters";
  ValidationType["MinNumericalSymbols"] = "minNumericalSymbols";
  ValidationType["MaxNumericalSymbols"] = "maxNumericalSymbols";
  ValidationType["CustomRule"] = "customRule";
})(ValidationType || (exports.ValidationType = ValidationType = {}));

var count = function count(target, callback) {
  var result = 0;

  for (var i = 0; i < target.length; i++) {
    if (callback(target[i])) {
      result++;
    }
  }

  return result;
};

exports.count = count;

var countUpperCase = function countUpperCase(target) {
  return count(target, function (e) {
    return e >= 'A' && e <= 'Z';
  });
};

exports.countUpperCase = countUpperCase;

var countNumbers = function countNumbers(target) {
  return count(target, function (e) {
    var n = parseInt(e);
    return typeof n === 'number' && !Number.isNaN(n);
  });
};

exports.countNumbers = countNumbers;
var validationFunc = (_validationFunc = {}, (0, _defineProperty2["default"])(_validationFunc, ValidationType.Require, function (value, isValid) {
  return isValid && value.toString().trim().length > 0;
}), (0, _defineProperty2["default"])(_validationFunc, ValidationType.MinLength, function (value, isValid, validator) {
  return isValid && value.toString().trim().length >= validator.value;
}), (0, _defineProperty2["default"])(_validationFunc, ValidationType.MaxLength, function (value, isValid, validator) {
  return isValid && value.toString().trim().length <= validator.value;
}), (0, _defineProperty2["default"])(_validationFunc, ValidationType.MinValue, function (value, isValid, validator) {
  return isValid && +value >= validator.value;
}), (0, _defineProperty2["default"])(_validationFunc, ValidationType.MaxValue, function (value, isValid, validator) {
  return isValid && +value <= validator.value;
}), (0, _defineProperty2["default"])(_validationFunc, ValidationType.MinUppercaseCharacters, function (value, isValid, validator) {
  var uppercaseChars = countUpperCase(value.toString());
  return isValid && uppercaseChars >= validator.value;
}), (0, _defineProperty2["default"])(_validationFunc, ValidationType.MaxUppercaseCharacters, function (value, isValid, validator) {
  var uppercaseChars = countUpperCase(value.toString());
  return isValid && uppercaseChars <= validator.value;
}), (0, _defineProperty2["default"])(_validationFunc, ValidationType.MinNumericalSymbols, function (value, isValid, validator) {
  var numericalSymbols = countNumbers(value.toString());
  return isValid && numericalSymbols >= validator.value;
}), (0, _defineProperty2["default"])(_validationFunc, ValidationType.MaxNumericalSymbols, function (value, isValid, validator) {
  var numericalSymbols = countNumbers(value.toString());
  return isValid && numericalSymbols <= validator.value;
}), (0, _defineProperty2["default"])(_validationFunc, ValidationType.CustomRule, function (value, isValid, validator, state) {
  return isValid && typeof validator.value === 'function' && validator.value(value, state);
}), _validationFunc);

var validateState = function validateState(state) {
  var isValid = true;

  for (var _key in state.inputs) {
    isValid = isValid && state.inputs[_key].isValid;
  }

  return isValid;
};

exports.validateState = validateState;

var getValidator = function getValidator(type, value) {
  return {
    type: type,
    value: value
  };
};

exports.getValidator = getValidator;

var validate = function validate(value, validators, state) {
  var isValid = true;
  validators.forEach(function (validator) {
    var func = validationFunc[validator.type];

    if (typeof func !== 'undefined') {
      isValid = func(value, isValid, validator, state);
    }
  });
  return isValid;
};

exports.validate = validate;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9mb3JtLnZhbGlkYXRpb24udHMiXSwibmFtZXMiOlsiVmFsaWRhdGlvblR5cGUiLCJjb3VudCIsInRhcmdldCIsImNhbGxiYWNrIiwicmVzdWx0IiwiaSIsImxlbmd0aCIsImNvdW50VXBwZXJDYXNlIiwiZSIsImNvdW50TnVtYmVycyIsIm4iLCJwYXJzZUludCIsIk51bWJlciIsImlzTmFOIiwidmFsaWRhdGlvbkZ1bmMiLCJSZXF1aXJlIiwidmFsdWUiLCJpc1ZhbGlkIiwidG9TdHJpbmciLCJ0cmltIiwiTWluTGVuZ3RoIiwidmFsaWRhdG9yIiwiTWF4TGVuZ3RoIiwiTWluVmFsdWUiLCJNYXhWYWx1ZSIsIk1pblVwcGVyY2FzZUNoYXJhY3RlcnMiLCJ1cHBlcmNhc2VDaGFycyIsIk1heFVwcGVyY2FzZUNoYXJhY3RlcnMiLCJNaW5OdW1lcmljYWxTeW1ib2xzIiwibnVtZXJpY2FsU3ltYm9scyIsIk1heE51bWVyaWNhbFN5bWJvbHMiLCJDdXN0b21SdWxlIiwic3RhdGUiLCJ2YWxpZGF0ZVN0YXRlIiwia2V5IiwiaW5wdXRzIiwiZ2V0VmFsaWRhdG9yIiwidHlwZSIsInZhbGlkYXRlIiwidmFsaWRhdG9ycyIsImZvckVhY2giLCJmdW5jIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7O0FBRUE7QUFDQTtJQUNZQSxjO0FBYVo7QUFDQTtBQUNBOzs7O1dBZllBLGM7QUFBQUEsRUFBQUEsYztBQUFBQSxFQUFBQSxjO0FBQUFBLEVBQUFBLGM7QUFBQUEsRUFBQUEsYztBQUFBQSxFQUFBQSxjO0FBQUFBLEVBQUFBLGM7QUFBQUEsRUFBQUEsYztBQUFBQSxFQUFBQSxjO0FBQUFBLEVBQUFBLGM7QUFBQUEsRUFBQUEsYztHQUFBQSxjLDhCQUFBQSxjOztBQW1DTCxJQUFNQyxLQUFLLEdBQUcsU0FBUkEsS0FBUSxDQUFDQyxNQUFELEVBQWlCQyxRQUFqQixFQUFrRTtBQUNuRixNQUFJQyxNQUFNLEdBQUcsQ0FBYjs7QUFDQSxPQUFLLElBQUlDLENB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U0FBZkEsWUFBZSxDQUFDQyxJQUFELEVBQXVCckIsS0FBdkI7QUFBQSxTQUE4RDtBQUFFcUIsSUFBQUEsSUFBSSxFQUFKQSxJQUFGO0FBQVFyQixJQUFBQSxLQUFLLEVBQUxBO0FBQVIsR0FBOUQ7QUFBQSxDQUFyQjs7OztBQUVBLElBQU1zQixRQUFRLEdBQUcsU0FBWEEsUUFBVyxDQUFDdEIsS0FBRCxFQUF1QnVCLFVBQXZCLEVBQWdEUCxLQUFoRCxFQUFtRjtBQUN2RyxNQUFJZixPQUFnQixHQUFHLElBQXZCO0FBQ0FzQixFQUFBQSxVQUFVLENBQUNDLE9BQVgsQ0FBbUIsVUFBQ25CLFNBQUQsRUFBZTtBQUM5QixRQUFNb0IsSUFBZ0MsR0FBRzNCLGNBQWMsQ0FBQ08sU0FBUyxDQUFDZ0IsSUFBWCxDQUF2RDs7QUFDQSxRQUFJLE9BQU9JLElBQVAsS0FBZ0IsV0FBcEIsRUFBaUM7QUFDN0J4QixNQUFBQSxPQUFPLEdBQUd3QixJQUFJLENBQUN6QixLQUFELEVBQVFDLE9BQVIsRUFBaUJJLFNBQWpCLEVBQTRCVyxLQUE1QixDQUFkO0FBQ0g7QUFDSixHQUxEO0FBTUEsU0FBT2YsT0FBUDtBQUNILENBVE0iLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBGb3JtU3RhdGUsIEZvcm1WYWx1ZVR5cGUsIEZvcm1FbnRyeUNvbnN0cmFpbnQgfSBmcm9tICcuL2Zvcm0uaG9vayc7XG5cbi8qIFByZWRlZmluZWQgdmFsaWRhdGlvbiBvcHRpb25zLiBIb3dldmVyLCBhIGN1c3RvbSBydWxlLCB3aGljaCB0YWtlcyBhIGZ1bmN0aW9uLCBjYW4gYmUgY3JlYXRlZFxuICAgYW5kIHRodXMgYW55IHZhbGlkYXRpb24gcnVsZSB0aGF0IGlzIGRlc2lyZWQsIGNhbiBiZSBjcmVhdGVkLiAqL1xuZXhwb3J0IGVudW0gVmFsaWRhdGlvblR5cGUge1xuICAgIFJlcXVpcmUgPSAnaXNSZXF1aXJlZCcsXG4gICAgTWluTGVuZ3RoID0gJ21pbkxlbmd0aCcsXG4gICAgTWF4TGVuZ3RoID0gJ21heExlbmd0aCcsXG4gICAgTWluVmFsdWUgPSAnbWluVmFsdWUnLFxuICAgIE1heFZhbHVlID0gJ21heFZhbHVlJyxcbiAgICBNaW5VcHBlcmNhc2VDaGFyYWN0ZXJzID0gJ21pblVwcGVyY2FzZUNoYXJhY3RlcnMnLFxuICAgIE1heFVwcGVyY2FzZUNoYXJhY3RlcnMgPSAnbWF4VXBwZXJjYXNlQ2hhcmFjdGVycycsXG4gICAgTWluTnVtZXJpY2FsU3ltYm9scyA9ICdtaW5OdW1lcmljYWxTeW1ib2xzJyxcbiAgICBNYXhOdW1lcmljYWxTeW1ib2xzID0gJ21heE51bWVyaWNhbFN5bWJvbHMnLFxuICAgIEN1c3RvbVJ1bGUgPSAnY3VzdG9tUnVsZSdcbn1cblxuLyogRnVuY3Rpb24gdGhhdCBpcyB0aWVkIHRvIGEgY3VzdG9tIHJ1bGUuIE11c3QgcmV0dXJuIGEgYm9vbGVhbiBhbmQgd2lsbCBhbHdheXMgcmVjZWl2ZSB0d28gYXJndW1lbnRzOiBcbiAgIHZhbHVlOiBjdXJyZW50IHZhbHVlIG9mIHRoZSBpbnB1dCBmaWVsZCB3aGVyZSB0aGlzIGN1c3RvbSBydWxlIGlzIHRpZWQgXG4gICBzdGF0ZTogdGhlIG1vc3QgdXBkYXRlZCBzdGF0ZSBvZiB0aGUgZW50aXJlIGZvcm0uICovXG5leHBvcnQgdHlwZSBDdXN0b21WYWxpZGF0aW9uUnVsZTxUIGV4dGVuZHMgRm9ybVZhbHVlVHlwZSwgUyBleHRlbmRzIEZvcm1FbnRyeUNvbnN0cmFpbnQgPSBhbnk+ID0gKFxuICAgIHZhbHVlOiBULFxuICAgIHN0YXRlOiBGb3JtU3RhdGU8Uz5cbikgPT4gYm9vbGVhbjtcblxuZXhwb3J0IHR5cGUgVmFsaWRhdGlvblZhbHVlID0gRm9ybVZhbHVlVHlwZSB8IEN1c3RvbVZhbGlkYXRpb25SdWxlPGFueSwgYW55PjtcblxuZXhwb3J0IGludGVyZmFjZSBWYWxpZGF0b3Ige1xuICAgIHR5cGU6IFZhbGlkYXRpb25UeXBlO1xuICAgIHZhbHVlOiBWYWxpZGF0aW9uVmFsdWU7XG59XG5cbmV4cG9ydCB0eXBlIFZhbGlkYXRpb25GdW5jID0gKFxuICAgIHZhbHVlOiBGb3JtVmFsdWVUeXBlLFxuICAgIGlzVmFsaWQ6IGJvb2xlYW4sXG4gICAgdmFsaWRhdG9yOiBWYWxpZGF0b3IsXG4gICAgc3RhdGU6IEZvcm1TdGF0ZTxhbnk+XG4pID0+IGJvb2xlYW47XG5cbmV4cG9ydCBjb25zdCBjb3VudCA9ICh0YXJnZXQ6IHN0cmluZywgY2FsbGJhY2s6IChlbnRyeTogc3RyaW5nKSA9PiBib29sZWFuKTogbnVtYmVyID0+IHtcbiAgICBsZXQgcmVzdWx0ID0gMDtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRhcmdldC5sZW5ndGg7IGkrKykge1xuICAgICAgICBpZiAoY2FsbGJhY2sodGFyZ2V0W2ldKSkge1xuICAgICAgICAgICAgcmVzdWx0Kys7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbn07XG5cbmV4cG9ydCBjb25zdCBjb3VudFVwcGVyQ2FzZSA9ICh0YXJnZXQ6IHN0cmluZyk6IG51bWJlciA9PiB7XG4gICAgcmV0dXJuIGNvdW50KHRhcmdldCwgKGUpID0+IGUgPj0gJ0EnICYmIGUgPD0gJ1onKTtcbn07XG5cbmV4cG9ydCBjb25zdCBjb3VudE51bWJlcnMgPSAodGFyZ2V0OiBzdHJpbmcpOiBudW1iZXIgPT4ge1xuICAgIHJldHVybiBjb3VudCh0YXJnZXQsIChlKSA9PiB7XG4gICAgICAgIGNvbnN0IG4gPSBwYXJzZUludChlKTtcbiAgICAgICAgcmV0dXJuIHR5cGVvZiBuID09PSAnbnVtYmVyJyAmJiAhTnVtYmVyLmlzTmFOKG4pO1xuICAgIH0pO1xufTtcblxuY29uc3QgdmFsaWRhdGlvbkZ1bmM6IHsgW2tleTogc3RyaW5nXTogVmFsaWRhdGlvbkZ1bmMgfSA9IHtcbiAgICBbVmFsaWRhdGlvblR5cGUuUmVxdWlyZV06ICh2YWx1ZSwgaXNWYWxpZCkgPT4ge1xuICAgICAgICByZXR1cm4gaXNWYWxpZCAmJiB2YWx1ZS50b1N0cmluZygpLnRyaW0oKS5sZW5ndGggPiAwO1xuICAgIH0sXG4gICAgW1ZhbGlkYXRpb25UeXBlLk1pbkxlbmd0aF06ICh2YWx1ZSwgaXNWYWxpZCwgdmFsaWRhdG9yKSA9PiB7XG4gICAgICAgIHJldHVybiBpc1ZhbGlkICYmIHZhbHVlLnRvU3RyaW5nKCkudHJpbSgpLmxlbmd0aCA+PSB2YWxpZGF0b3IudmFsdWU7XG4gICAgfSxcbiAgICBbVmFsaWRhdGlvblR5cGUuTWF4TGVuZ3RoXTogKHZhbHVlLCBpc1ZhbGlkLCB2YWxpZGF0b3IpID0+IHtcbiAgICAgICAgcmV0dXJuIGlzVmFsaWQgJiYgdmFsdWUudG9TdHJpbmcoKS50cmltKCkubGVuZ3RoIDw9IHZhbGlkYXRvci52YWx1ZTtcbiAgICB9LFxuICAgIFtWYWxpZGF0aW9uVHlwZS5NaW5WYWx1ZV06ICh2YWx1ZSwgaXNWYWxpZCwgdmFsaWRhdG9yKSA9PiB7XG4gICAgICAgIHJldHVybiBpc1ZhbGlkICYmICt2YWx1ZSA+PSB2YWxpZGF0b3IudmFsdWU7XG4gICAgfSxcbiAgICBbVmFsaWRhdGlvblR5cGUuTWF4VmFsdWVdOiAodmFsdWUsIGlzVmFsaWQsIHZhbGlkYXRvcikgPT4ge1xuICAgICAgICByZXR1cm4gaXNWYWxpZCAmJiArdmFsdWUgPD0gdmFsaWRhdG9yLnZhbHVlO1xuICAgIH0sXG4gICAgW1ZhbGlkYXRpb25UeXBlLk1pblVwcGVyY2FzZUNoYXJhY3RlcnNdOiAodmFsdWUsIGlzVmFsaWQsIHZhbGlkYXRvcikgPT4ge1xuICAgICAgICBjb25zdCB1cHBlcmNhc2VDaGFyczogbnVtYmVyID0gY291bnRVcHBlckNhc2UodmFsdWUudG9TdHJpbmcoKSk7XG4gICAgICAgIHJldHVybiBpc1ZhbGlkICYmIHVwcGVyY2FzZUNoYXJzID49IHZhbGlkYXRvci52YWx1ZTtcbiAgICB9LFxuICAgIFtWYWxpZGF0aW9uVHlwZS5NYXhVcHBlcmNhc2VDaGFyYWN0ZXJzXTogKHZhbHVlLCBpc1ZhbGlkLCB2YWxpZGF0b3IpID0+IHtcbiAgICAgICAgY29uc3QgdXBwZXJjYXNlQ2hhcnM6IG51bWJlciA9IGNvdW50VXBwZXJDYXNlKHZhbHVlLnRvU3RyaW5nKCkpO1xuICAgICAgICByZXR1cm4gaXNWYWxpZCAmJiB1cHBlcmNhc2VDaGFycyA8PSB2YWxpZGF0b3IudmFsdWU7XG4gICAgfSxcbiAgICBbVmFsaWRhdGlvblR5cGUuTWluTnVtZXJpY2FsU3ltYm9sc106ICh2YWx1ZSwgaXNWYWxpZCwgdmFsaWRhdG9yKSA9PiB7XG4gICAgICAgIGNvbnN0IG51bWVyaWNhbFN5bWJvbHM6IG51bWJlciA9IGNvdW50TnVtYmVycyh2YWx1ZS50b1N0cmluZygpKTtcbiAgICAgICAgcmV0dXJuIGlzVmFsaWQgJiYgbnVtZXJpY2FsU3ltYm9scyA+PSB2YWxpZGF0b3IudmFsdWU7XG4gICAgfSxcbiAgICBbVmFsaWRhdGlvblR5cGUuTWF4TnVtZXJpY2FsU3ltYm9sc106ICh2YWx1ZSwgaXNWYWxpZCwgdmFsaWRhdG9yKSA9PiB7XG4gICAgICAgIGNvbnN0IG51bWVyaWNhbFN5bWJvbHM6IG51bWJlciA9IGNvdW50TnVtYmVycyh2YWx1ZS50b1N0cmluZygpKTtcbiAgICAgICAgcmV0dXJuIGlzVmFsaWQgJiYgbnVtZXJpY2FsU3ltYm9scyA8PSB2YWxpZGF0b3IudmFsdWU7XG4gICAgfSxcbiAgICBbVmFsaWRhdGlvblR5cGUuQ3VzdG9tUnVsZV06ICh2YWx1ZSwgaXNWYWxpZCwgdmFsaWRhdG9yLCBzdGF0ZSkgPT4ge1xuICAgICAgICByZXR1cm4gaXNWYWxpZCAmJiB0eXBlb2YgdmFsaWRhdG9yLnZhbHVlID09PSAnZnVuY3Rpb24nICYmIHZhbGlkYXRvci52YWx1ZSh2YWx1ZSwgc3RhdGUpO1xuICAgIH1cbn07XG5cbmV4cG9ydCBjb25zdCB2YWxpZGF0ZVN0YXRlID0gKHN0YXRlOiBGb3JtU3RhdGU8YW55Pik6IGJvb2xlYW4gPT4ge1xuICAgIGxldCBpc1ZhbGlkOiBib29sZWFuID0gdHJ1ZTtcbiAgICBmb3IgKGNvbnN0IGtleSBpbiBzdGF0ZS5pbnB1dHMpIHtcbiAgICAgICAgaXNWYWxpZCA9IGlzVmFsaWQgJiYgc3RhdGUuaW5wdXRzW2tleV0uaXNWYWxpZDtcbiAgICB9XG4gICAgcmV0dXJuIGlzVmFsaWQ7XG59O1xuXG5leHBvcnQgY29uc3QgZ2V0VmFsaWRhdG9yID0gKHR5cGU6IFZhbGlkYXRpb25UeXBlLCB2YWx1ZTogVmFsaWRhdGlvblZhbHVlKTogVmFsaWRhdG9yID0+ICh7IHR5cGUsIHZhbHVlIH0pO1xuXG5leHBvcnQgY29uc3QgdmFsaWRhdGUgPSAodmFsdWU6IEZvcm1WYWx1ZVR5cGUsIHZhbGlkYXRvcnM6IFZhbGlkYXRvcltdLCBzdGF0ZTogRm9ybVN0YXRlPGFueT4pOiBib29sZWFuID0+IHtcbiAgICBsZXQgaXNWYWxpZDogYm9vbGVhbiA9IHRydWU7XG4gICAgdmFsaWRhdG9ycy5mb3JFYWNoKCh2YWxpZGF0b3IpID0+IHtcbiAgICAgICAgY29uc3QgZnVuYzogVmFsaWRhdGlvbkZ1bmMgfCB1bmRlZmluZWQgPSB2YWxpZGF0aW9uRnVuY1t2YWxpZGF0b3IudHlwZV07XG4gICAgICAgIGlmICh0eXBlb2YgZnVuYyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgIGlzVmFsaWQgPSBmdW5jKHZhbHVlLCBpc1ZhbGlkLCB2YWxpZGF0b3IsIHN0YXRlKTtcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiBpc1ZhbGlkO1xufTtcbiJdfQ==