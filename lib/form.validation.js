"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.validate = exports.getValidator = exports.ValidationType = void 0;

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _validationFunc;

var ValidationType;
exports.ValidationType = ValidationType;

(function (ValidationType) {
  ValidationType["Require"] = "isRequired";
  ValidationType["MinLength"] = "minLength";
  ValidationType["MaxLength"] = "maxLength";
  ValidationType["MinValue"] = "minValue";
  ValidationType["MaxValue"] = "maxValue";
  ValidationType["MinUppercaseCharacters"] = "minUppercaseCharacters";
  ValidationType["MaxUppercaseCharacters"] = "maxUppercaseCharacters";
  ValidationType["MinNumericalSymbols"] = "minNumericalSymbols";
  ValidationType["MaxNumericalSymbols"] = "maxNumericalSymbols";
  ValidationType["CustomRule"] = "customRule";
})(ValidationType || (exports.ValidationType = ValidationType = {}));

var count = function count(target, callback) {
  var result = 0;

  for (var i = 0; i < target.length; i++) {
    if (callback(target[i])) {
      result++;
    }
  }

  return result;
};

var validationFunc = (_validationFunc = {}, (0, _defineProperty2["default"])(_validationFunc, ValidationType.Require, function (value, isValid) {
  return isValid && value.toString().trim().length > 0;
}), (0, _defineProperty2["default"])(_validationFunc, ValidationType.MinLength, function (value, isValid, validator) {
  return isValid && value.toString().trim().length >= validator.value;
}), (0, _defineProperty2["default"])(_validationFunc, ValidationType.MaxLength, function (value, isValid, validator) {
  return isValid && value.toString().trim().length <= validator.value;
}), (0, _defineProperty2["default"])(_validationFunc, ValidationType.MinValue, function (value, isValid, validator) {
  return isValid && +value >= validator.value;
}), (0, _defineProperty2["default"])(_validationFunc, ValidationType.MaxValue, function (value, isValid, validator) {
  return isValid && +value <= validator.value;
}), (0, _defineProperty2["default"])(_validationFunc, ValidationType.MinUppercaseCharacters, function (value, isValid, validator) {
  var uppercaseChars = count(value.toString(), function (e) {
    return e >= 'A' && e <= 'Z';
  });
  return isValid && uppercaseChars >= validator.value;
}), (0, _defineProperty2["default"])(_validationFunc, ValidationType.MaxUppercaseCharacters, function (value, isValid, validator) {
  var uppercaseChars = count(value.toString(), function (e) {
    return e >= 'A' && e <= 'Z';
  });
  return isValid && uppercaseChars <= validator.value;
}), (0, _defineProperty2["default"])(_validationFunc, ValidationType.MinNumericalSymbols, function (value, isValid, validator) {
  var numericalSymbols = count(value.toString(), function (e) {
    var n = parseInt(e);
    return typeof n === 'number' && !Number.isNaN(n);
  });
  return isValid && numericalSymbols >= validator.value;
}), (0, _defineProperty2["default"])(_validationFunc, ValidationType.MaxNumericalSymbols, function (value, isValid, validator) {
  var numericalSymbols = count(value.toString(), function (e) {
    var n = parseInt(e);
    return typeof n === 'number' && !Number.isNaN(n);
  });
  return isValid && numericalSymbols <= validator.value;
}), (0, _defineProperty2["default"])(_validationFunc, ValidationType.CustomRule, function (value, isValid, validator, state) {
  return isValid && typeof validator.value === 'function' && validator.value(value, state);
}), _validationFunc);

var getValidator = function getValidator(type, value) {
  return {
    type: type,
    value: value
  };
};

exports.getValidator = getValidator;

var validate = function validate(value, validators, state) {
  var isValid = true;
  validators.forEach(function (validator) {
    var func = validationFunc[validator.type];

    if (typeof func !== 'undefined') {
      isValid = func(value, isValid, validator, state);
    }
  });
  return isValid;
};

exports.validate = validate;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9mb3JtLnZhbGlkYXRpb24udHMiXSwibmFtZXMiOlsiVmFsaWRhdGlvblR5cGUiLCJjb3VudCIsInRhcmdldCIsImNhbGxiYWNrIiwicmVzdWx0IiwiaSIsImxlbmd0aCIsInZhbGlkYXRpb25GdW5jIiwiUmVxdWlyZSIsInZhbHVlIiwiaXNWYWxpZCIsInRvU3RyaW5nIiwidHJpbSIsIk1pbkxlbmd0aCIsInZhbGlkYXRvciIsIk1heExlbmd0aCIsIk1pblZhbHVlIiwiTWF4VmFsdWUiLCJNaW5VcHBlcmNhc2VDaGFyYWN0ZXJzIiwidXBwZXJjYXNlQ2hhcnMiLCJlIiwiTWF4VXBwZXJjYXNlQ2hhcmFjdGVycyIsIk1pbk51bWVyaWNhbFN5bWJvbHMiLCJudW1lcmljYWxTeW1ib2xzIiwibiIsInBhcnNlSW50IiwiTnVtYmVyIiwiaXNOYU4iLCJNYXhOdW1lcmljYWxTeW1ib2xzIiwiQ3VzdG9tUnVsZSIsInN0YXRlIiwiZ2V0VmFsaWRhdG9yIiwidHlwZSIsInZhbGlkYXRlIiwidmFsaWRhdG9ycyIsImZvckVhY2giLCJmdW5jIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7O0lBRVlBLGM7OztXQUFBQSxjO0FBQUFBLEVBQUFBLGM7QUFBQUEsRUFBQUEsYztBQUFBQSxFQUFBQSxjO0FBQUFBLEVBQUFBLGM7QUFBQUEsRUFBQUEsYztBQUFBQSxFQUFBQSxjO0FBQUFBLEVBQUFBLGM7QUFBQUEsRUFBQUEsYztBQUFBQSxFQUFBQSxjO0FBQUFBLEVBQUFBLGM7R0FBQUEsYyw4QkFBQUEsYzs7QUFnQ1osSUFBTUMsS0FBSyxHQUFHLFNBQVJBLEtBQVEsQ0FBQ0MsTUFBRCxFQUFpQkMsUUFBakIsRUFBa0U7QUFDNUUsTUFBSUMsTUFBTSxHQUFHLENBQWI7O0FBQ0EsT0FBSyxJQUFJQyxDQUFDLEdBQUcsQ0FBYixFQUFnQkEsQ0FBQyxHQUFHSCxNQUFNLENBQUNJLE1BQTNCLEVBQW1DRCxDQUFDLEVBQXBDLEVBQXdDO0FBQ3BDLFFBQUlGLFFBQVEs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QWdDLEdBQUc3QixjQUFjLENBQUNPLFNBQVMsQ0FBQ2tCLElBQVgsQ0FBdkQ7O0FBQ0EsUUFBSSxPQUFPSSxJQUFQLEtBQWdCLFdBQXBCLEVBQWlDO0FBQzdCMUIsTUFBQUEsT0FBTyxHQUFHMEIsSUFBSSxDQUFDM0IsS0FBRCxFQUFRQyxPQUFSLEVBQWlCSSxTQUFqQixFQUE0QmdCLEtBQTVCLENBQWQ7QUFDSDtBQUNKLEdBTEQ7QUFNQSxTQUFPcEIsT0FBUDtBQUNILENBVE0iLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBGb3JtU3RhdGUsIEZvcm1WYWx1ZVR5cGUsIEZvcm1TdGF0ZUNvbnN0cmFpbnQgfSBmcm9tICcuL2Zvcm0uaG9vayc7XG5cbmV4cG9ydCBlbnVtIFZhbGlkYXRpb25UeXBlIHtcbiAgICBSZXF1aXJlID0gJ2lzUmVxdWlyZWQnLFxuICAgIE1pbkxlbmd0aCA9ICdtaW5MZW5ndGgnLFxuICAgIE1heExlbmd0aCA9ICdtYXhMZW5ndGgnLFxuICAgIE1pblZhbHVlID0gJ21pblZhbHVlJyxcbiAgICBNYXhWYWx1ZSA9ICdtYXhWYWx1ZScsXG4gICAgTWluVXBwZXJjYXNlQ2hhcmFjdGVycyA9ICdtaW5VcHBlcmNhc2VDaGFyYWN0ZXJzJyxcbiAgICBNYXhVcHBlcmNhc2VDaGFyYWN0ZXJzID0gJ21heFVwcGVyY2FzZUNoYXJhY3RlcnMnLFxuICAgIE1pbk51bWVyaWNhbFN5bWJvbHMgPSAnbWluTnVtZXJpY2FsU3ltYm9scycsXG4gICAgTWF4TnVtZXJpY2FsU3ltYm9scyA9ICdtYXhOdW1lcmljYWxTeW1ib2xzJyxcbiAgICBDdXN0b21SdWxlID0gJ2N1c3RvbVJ1bGUnXG59XG5cbmV4cG9ydCB0eXBlIEN1c3RvbVZhbGlkYXRpb25SdWxlPFQgZXh0ZW5kcyBGb3JtVmFsdWVUeXBlLCBTIGV4dGVuZHMgRm9ybVN0YXRlQ29uc3RyYWludCA9IGFueT4gPSAoXG4gICAgdmFsdWU6IFQsXG4gICAgc3RhdGU6IEZvcm1TdGF0ZTxTPlxuKSA9PiBib29sZWFuO1xuXG5leHBvcnQgdHlwZSBWYWxpZGF0aW9uVmFsdWUgPSBGb3JtVmFsdWVUeXBlIHwgQ3VzdG9tVmFsaWRhdGlvblJ1bGU8YW55LCBhbnk+O1xuXG5leHBvcnQgaW50ZXJmYWNlIFZhbGlkYXRvciB7XG4gICAgdHlwZTogVmFsaWRhdGlvblR5cGU7XG4gICAgdmFsdWU6IFZhbGlkYXRpb25WYWx1ZTtcbn1cblxuZXhwb3J0IHR5cGUgVmFsaWRhdGlvbkZ1bmMgPSAoXG4gICAgdmFsdWU6IEZvcm1WYWx1ZVR5cGUsXG4gICAgaXNWYWxpZDogYm9vbGVhbixcbiAgICB2YWxpZGF0b3I6IFZhbGlkYXRvcixcbiAgICBzdGF0ZTogRm9ybVN0YXRlPGFueT5cbikgPT4gYm9vbGVhbjtcblxuY29uc3QgY291bnQgPSAodGFyZ2V0OiBzdHJpbmcsIGNhbGxiYWNrOiAoZW50cnk6IHN0cmluZykgPT4gYm9vbGVhbik6IG51bWJlciA9PiB7XG4gICAgbGV0IHJlc3VsdCA9IDA7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0YXJnZXQubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKGNhbGxiYWNrKHRhcmdldFtpXSkpIHtcbiAgICAgICAgICAgIHJlc3VsdCsrO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG59O1xuXG5jb25zdCB2YWxpZGF0aW9uRnVuYzogeyBba2V5OiBzdHJpbmddOiBWYWxpZGF0aW9uRnVuYyB9ID0ge1xuICAgIFtWYWxpZGF0aW9uVHlwZS5SZXF1aXJlXTogKHZhbHVlLCBpc1ZhbGlkKSA9PiB7XG4gICAgICAgIHJldHVybiBpc1ZhbGlkICYmIHZhbHVlLnRvU3RyaW5nKCkudHJpbSgpLmxlbmd0aCA+IDA7XG4gICAgfSxcbiAgICBbVmFsaWRhdGlvblR5cGUuTWluTGVuZ3RoXTogKHZhbHVlLCBpc1ZhbGlkLCB2YWxpZGF0b3IpID0+IHtcbiAgICAgICAgcmV0dXJuIGlzVmFsaWQgJiYgdmFsdWUudG9TdHJpbmcoKS50cmltKCkubGVuZ3RoID49IHZhbGlkYXRvci52YWx1ZTtcbiAgICB9LFxuICAgIFtWYWxpZGF0aW9uVHlwZS5NYXhMZW5ndGhdOiAodmFsdWUsIGlzVmFsaWQsIHZhbGlkYXRvcikgPT4ge1xuICAgICAgICByZXR1cm4gaXNWYWxpZCAmJiB2YWx1ZS50b1N0cmluZygpLnRyaW0oKS5sZW5ndGggPD0gdmFsaWRhdG9yLnZhbHVlO1xuICAgIH0sXG4gICAgW1ZhbGlkYXRpb25UeXBlLk1pblZhbHVlXTogKHZhbHVlLCBpc1ZhbGlkLCB2YWxpZGF0b3IpID0+IHtcbiAgICAgICAgcmV0dXJuIGlzVmFsaWQgJiYgK3ZhbHVlID49IHZhbGlkYXRvci52YWx1ZTtcbiAgICB9LFxuICAgIFtWYWxpZGF0aW9uVHlwZS5NYXhWYWx1ZV06ICh2YWx1ZSwgaXNWYWxpZCwgdmFsaWRhdG9yKSA9PiB7XG4gICAgICAgIHJldHVybiBpc1ZhbGlkICYmICt2YWx1ZSA8PSB2YWxpZGF0b3IudmFsdWU7XG4gICAgfSxcbiAgICBbVmFsaWRhdGlvblR5cGUuTWluVXBwZXJjYXNlQ2hhcmFjdGVyc106ICh2YWx1ZSwgaXNWYWxpZCwgdmFsaWRhdG9yKSA9PiB7XG4gICAgICAgIGNvbnN0IHVwcGVyY2FzZUNoYXJzOiBudW1iZXIgPSBjb3VudCh2YWx1ZS50b1N0cmluZygpLCAoZSkgPT4gZSA+PSAnQScgJiYgZSA8PSAnWicpO1xuICAgICAgICByZXR1cm4gaXNWYWxpZCAmJiB1cHBlcmNhc2VDaGFycyA+PSB2YWxpZGF0b3IudmFsdWU7XG4gICAgfSxcbiAgICBbVmFsaWRhdGlvblR5cGUuTWF4VXBwZXJjYXNlQ2hhcmFjdGVyc106ICh2YWx1ZSwgaXNWYWxpZCwgdmFsaWRhdG9yKSA9PiB7XG4gICAgICAgIGNvbnN0IHVwcGVyY2FzZUNoYXJzOiBudW1iZXIgPSBjb3VudCh2YWx1ZS50b1N0cmluZygpLCAoZSkgPT4gZSA+PSAnQScgJiYgZSA8PSAnWicpO1xuICAgICAgICByZXR1cm4gaXNWYWxpZCAmJiB1cHBlcmNhc2VDaGFycyA8PSB2YWxpZGF0b3IudmFsdWU7XG4gICAgfSxcbiAgICBbVmFsaWRhdGlvblR5cGUuTWluTnVtZXJpY2FsU3ltYm9sc106ICh2YWx1ZSwgaXNWYWxpZCwgdmFsaWRhdG9yKSA9PiB7XG4gICAgICAgIGNvbnN0IG51bWVyaWNhbFN5bWJvbHM6IG51bWJlciA9IGNvdW50KHZhbHVlLnRvU3RyaW5nKCksIChlKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBuID0gcGFyc2VJbnQoZSk7XG4gICAgICAgICAgICByZXR1cm4gdHlwZW9mIG4gPT09ICdudW1iZXInICYmICFOdW1iZXIuaXNOYU4obik7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gaXNWYWxpZCAmJiBudW1lcmljYWxTeW1ib2xzID49IHZhbGlkYXRvci52YWx1ZTtcbiAgICB9LFxuICAgIFtWYWxpZGF0aW9uVHlwZS5NYXhOdW1lcmljYWxTeW1ib2xzXTogKHZhbHVlLCBpc1ZhbGlkLCB2YWxpZGF0b3IpID0+IHtcbiAgICAgICAgY29uc3QgbnVtZXJpY2FsU3ltYm9sczogbnVtYmVyID0gY291bnQodmFsdWUudG9TdHJpbmcoKSwgKGUpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IG4gPSBwYXJzZUludChlKTtcbiAgICAgICAgICAgIHJldHVybiB0eXBlb2YgbiA9PT0gJ251bWJlcicgJiYgIU51bWJlci5pc05hTihuKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBpc1ZhbGlkICYmIG51bWVyaWNhbFN5bWJvbHMgPD0gdmFsaWRhdG9yLnZhbHVlO1xuICAgIH0sXG4gICAgW1ZhbGlkYXRpb25UeXBlLkN1c3RvbVJ1bGVdOiAodmFsdWUsIGlzVmFsaWQsIHZhbGlkYXRvciwgc3RhdGUpID0+IHtcbiAgICAgICAgcmV0dXJuIGlzVmFsaWQgJiYgdHlwZW9mIHZhbGlkYXRvci52YWx1ZSA9PT0gJ2Z1bmN0aW9uJyAmJiB2YWxpZGF0b3IudmFsdWUodmFsdWUsIHN0YXRlKTtcbiAgICB9XG59O1xuXG5leHBvcnQgY29uc3QgZ2V0VmFsaWRhdG9yID0gKHR5cGU6IFZhbGlkYXRpb25UeXBlLCB2YWx1ZTogRm9ybVZhbHVlVHlwZSk6IFZhbGlkYXRvciA9PiAoeyB0eXBlLCB2YWx1ZSB9KTtcblxuZXhwb3J0IGNvbnN0IHZhbGlkYXRlID0gKHZhbHVlOiBGb3JtVmFsdWVUeXBlLCB2YWxpZGF0b3JzOiBWYWxpZGF0b3JbXSwgc3RhdGU6IEZvcm1TdGF0ZTxhbnk+KTogYm9vbGVhbiA9PiB7XG4gICAgbGV0IGlzVmFsaWQ6IGJvb2xlYW4gPSB0cnVlO1xuICAgIHZhbGlkYXRvcnMuZm9yRWFjaCgodmFsaWRhdG9yKSA9PiB7XG4gICAgICAgIGNvbnN0IGZ1bmM6IFZhbGlkYXRpb25GdW5jIHwgdW5kZWZpbmVkID0gdmFsaWRhdGlvbkZ1bmNbdmFsaWRhdG9yLnR5cGVdO1xuICAgICAgICBpZiAodHlwZW9mIGZ1bmMgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICBpc1ZhbGlkID0gZnVuYyh2YWx1ZSwgaXNWYWxpZCwgdmFsaWRhdG9yLCBzdGF0ZSk7XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gaXNWYWxpZDtcbn07XG4iXX0=